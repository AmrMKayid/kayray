Traceback (most recent call last):
  File "/Users/amrmkayid/anaconda3/envs/kayddrl/lib/python3.6/site-packages/ray/tune/trial_runner.py", line 436, in _process_trial
    result = self.trial_executor.fetch_result(trial)
  File "/Users/amrmkayid/anaconda3/envs/kayddrl/lib/python3.6/site-packages/ray/tune/ray_trial_executor.py", line 323, in fetch_result
    result = ray.get(trial_future[0])
  File "/Users/amrmkayid/anaconda3/envs/kayddrl/lib/python3.6/site-packages/ray/worker.py", line 2195, in get
    raise value
ray.exceptions.RayTaskError: [36mray_PPO:train()[39m (pid=43996, host=KayidmacOS)
  File "/Users/amrmkayid/anaconda3/envs/kayddrl/lib/python3.6/site-packages/ray/rllib/agents/trainer.py", line 364, in train
    raise e
  File "/Users/amrmkayid/anaconda3/envs/kayddrl/lib/python3.6/site-packages/ray/rllib/agents/trainer.py", line 353, in train
    result = Trainable.train(self)
  File "/Users/amrmkayid/anaconda3/envs/kayddrl/lib/python3.6/site-packages/ray/tune/trainable.py", line 150, in train
    result = self._train()
  File "/Users/amrmkayid/anaconda3/envs/kayddrl/lib/python3.6/site-packages/ray/rllib/agents/trainer_template.py", line 126, in _train
    fetches = self.optimizer.step()
  File "/Users/amrmkayid/anaconda3/envs/kayddrl/lib/python3.6/site-packages/ray/rllib/optimizers/multi_gpu_optimizer.py", line 130, in step
    self.num_envs_per_worker, self.train_batch_size)
  File "/Users/amrmkayid/anaconda3/envs/kayddrl/lib/python3.6/site-packages/ray/rllib/optimizers/rollout.py", line 29, in collect_samples
    next_sample = ray_get_and_free(fut_sample)
  File "/Users/amrmkayid/anaconda3/envs/kayddrl/lib/python3.6/site-packages/ray/rllib/utils/memory.py", line 33, in ray_get_and_free
    result = ray.get(object_ids)
ray.exceptions.RayTaskError: [36mray_RolloutWorker:sample()[39m (pid=43997, host=KayidmacOS)
  File "/Users/amrmkayid/anaconda3/envs/kayddrl/lib/python3.6/site-packages/mlagents/envs/rpc_communicator.py", line 70, in check_port
    s.bind(("localhost", port))
OSError: [Errno 48] Address already in use

During handling of the above exception, another exception occurred:

[36mray_RolloutWorker:sample()[39m (pid=43997, host=KayidmacOS)
  File "/Users/amrmkayid/anaconda3/envs/kayddrl/lib/python3.6/site-packages/ray/rllib/evaluation/rollout_worker.py", line 253, in __init__
    self.env = _validate_env(env_creator(env_context))
  File "test_env.py", line 146, in <lambda>
    lambda config: make_unity_env(config, env_name=env_name))
  File "/Users/amrmkayid/Desktop/kayray/kayray/envs/unity.py", line 30, in make_unity_env
    return UnityRayEnv(env_config, env_name)
  File "/Users/amrmkayid/Desktop/kayray/kayray/envs/unity.py", line 17, in __init__
    self._env = UnityEnv(environment_filename=env_name, worker_id=UnityRayEnv.worker_id, no_graphics=no_graphics, multiagent=multiagent) #, use_visual=True)
  File "/Users/amrmkayid/anaconda3/envs/kayddrl/lib/python3.6/site-packages/gym_unity/envs/unity_env.py", line 51, in __init__
    environment_filename, worker_id, no_graphics=no_graphics
  File "/Users/amrmkayid/anaconda3/envs/kayddrl/lib/python3.6/site-packages/mlagents/envs/environment.py", line 48, in __init__
    self.communicator = self.get_communicator(worker_id, base_port)
  File "/Users/amrmkayid/anaconda3/envs/kayddrl/lib/python3.6/site-packages/mlagents/envs/environment.py", line 211, in get_communicator
    return RpcCommunicator(worker_id, base_port)
  File "/Users/amrmkayid/anaconda3/envs/kayddrl/lib/python3.6/site-packages/mlagents/envs/rpc_communicator.py", line 43, in __init__
    self.create_server()
  File "/Users/amrmkayid/anaconda3/envs/kayddrl/lib/python3.6/site-packages/mlagents/envs/rpc_communicator.py", line 49, in create_server
    self.check_port(self.port)
  File "/Users/amrmkayid/anaconda3/envs/kayddrl/lib/python3.6/site-packages/mlagents/envs/rpc_communicator.py", line 72, in check_port
    raise UnityWorkerInUseException(self.worker_id)
mlagents.envs.exception.UnityWorkerInUseException: Couldn't start socket communication because worker number 0 is still in use. You may need to manually close a previously opened environment or use a different worker number.


